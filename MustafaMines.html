<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MustafaMines</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #222;
            color: white;
            text-align: center;
            margin: 0;
            padding: 0;
        }
        h1 {
            margin: 20px;
            font-size: 24px;
        }
        .settings {
            margin-top: 20px;
            position: absolute;
            bottom: 150px;
            width: 100%;
            text-align: center;
        }
        .board {
            display: grid;
            grid-template-columns: repeat(40, 20px); /* 40 h√ºcre i√ßin geni≈ülik */
            grid-template-rows: repeat(40, 20px);    /* 40 h√ºcre i√ßin y√ºkseklik */
            gap: 2px;
            justify-content: center;
            margin-top: 20px;
        }
        button {
            width: 20px;
            height: 20px;
            font-size: 12px;
            background-color: #444;
            color: white;
            border: 1px solid #999;
            cursor: pointer;
        }
        button.revealed {
            background-color: #ddd;
            color: black;
        }
        button.mine {
            background-color: red;
        }
        .message {
            margin-top: 20px;
            font-size: 20px;
            color: yellow;
            position: absolute;
            top: 52%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .score {
            font-size: 20px;
            color: white;
            margin-top: 10px;
        }
        .spent {
            font-size: 18px;
            color: red;
            margin-top: 10px;
        }
        .points-accumulated {
            font-size: 18px;
            color: lightblue;
            margin-top: 10px;
        }
        .spend-message {
            font-size: 18px;
            color: orange;
            margin-top: 10px;
        }
        .error {
            font-size: 18px;
            color: red;
            margin-top: 10px;
        }
        .multiplier {
            font-size: 12px;
            color: yellow;
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
        }
        img {
            margin-left: 5px; /* Resmin metin ile arasƒ±na bo≈üluk ekler */
            vertical-align: middle; /* Resmin metinle hizalanmasƒ±nƒ± saƒülar */
            width: 40px; /* MusCoin g√∂rselinin boyutu 40px x 40px */
            height: 40px; /* MusCoin g√∂rselinin boyutu 40px x 40px */
        }
    </style>
</head>
<body>

<h1>MustafaMines</h1>

<!-- Board Section -->
<div id="board" class="board"></div>

<!-- Score and Game Over / Win Message -->
<div id="message" class="message"></div>

<!-- Score, Spent, Accumulated Points -->
<div id="score" class="score">MusCoin: <img src="muscoin.png" alt="coin"></div>
<div id="spent" class="spent">Giri≈ü i√ßin harcanan MusCoin: <img src="muscoin.png" alt="coin"></div>
<div id="pointsAccumulated" class="points-accumulated">Biriken MusCoin: <img src="muscoin.png" alt="coin"></div>
<div id="spendMessage" class="spend-message"></div>
<div id="errorMessage" class="error"></div> <!-- Hata mesajƒ± i√ßin yeni bir alan -->

<!-- Settings Section (Alt Kƒ±sƒ±mda) -->
<div class="settings">
    <label for="mineCount">Mayƒ±n Sayƒ±sƒ±nƒ± Se√ß: </label>
    <input type="number" id="mineCount" value="5" min="1" max="40">
    <br><br>
    <label for="enterPoints">Giri≈ü ƒ∞√ßin Harcanan MusCoin: </label>
    <input type="number" id="enterPoints" value="100" min="1">
    <br><br>
    <button onclick="startGame()">Oyunu Ba≈ülat</button>
    <button onclick="spendPoints()">MusCoini √áek</button>
</div>

<script>
    const gridSize = 40; // Grid boyutunu 40x40 olarak ayarladƒ±k
    let numMines = 5;  // Ba≈ülangƒ±√ßta 5 mayƒ±n
    let board = [];
    let revealedCount = 0;
    let score = 1000;   // Ba≈ülangƒ±√ß puanƒ± 1000
    let spentPoints = 0; // Harcanan puan
    let accumulatedPoints = 0; // Biriken puan
    let enteredPoints = 0; // Girdiƒüi puan
    let gameOver = false;
    let isFirstCellClicked = false; // ƒ∞lk tƒ±klama kontrol√º

    // Oyun tahtasƒ±nƒ± olu≈ütur
    function createBoard() {
        board = [];
        revealedCount = 0;
        gameOver = false;

        // Grid ile bo≈ü h√ºcreler olu≈ütur
        for (let row = 0; row < gridSize; row++) {
            let rowArray = [];
            for (let col = 0; col < gridSize; col++) {
                rowArray.push({ mine: false, revealed: false });
            }
            board.push(rowArray);
        }

        // Rastgele mayƒ±nlarƒ± yerle≈ütir
        let minesPlaced = 0;
        while (minesPlaced < numMines) {
            let row = Math.floor(Math.random() * gridSize);
            let col = Math.floor(Math.random() * gridSize);
            if (!board[row][col].mine) {
                board[row][col].mine = true;
                minesPlaced++;
            }
        }
    }

    // H√ºcreyi a√ß
    function revealCell(row, col) {
        if (board[row][col].revealed || gameOver) return;

        const cell = document.getElementById(`cell-${row}-${col}`);
        board[row][col].revealed = true;
        revealedCount++;

        if (!isFirstCellClicked) {
            enteredPoints = spentPoints;  // ƒ∞lk tƒ±klamada girdiƒüi puan alƒ±nƒ±r
            isFirstCellClicked = true;    // ƒ∞lk tƒ±klama yapƒ±ldƒ±ƒüƒ±nda deƒüi≈ükeni true yap
        } else {
            enteredPoints = enteredPoints * 1.1; // Sonraki tƒ±klamalarda biriken puan ile √ßarpƒ±lƒ±r
        }

        // Mayƒ±na basƒ±ldƒ±ƒüƒ±nda, kazan√ß puanƒ±nƒ± eklemeyin
        if (board[row][col].mine) {
            cell.classList.add('mine');
            const multiplierElement = document.createElement('div');
            multiplierElement.classList.add('multiplier');
            multiplierElement.textContent = `x${Math.floor(enteredPoints)}`; // √áarpan deƒüeri burada yazƒ±lacak
            cell.appendChild(multiplierElement);
            cell.textContent = 'üí£'; // Mayƒ±n simgesi

            showAllMines(); // T√ºm mayƒ±nlarƒ± g√∂ster
            document.getElementById("message").textContent = `Mayƒ±na bastƒ±nƒ±z! Oyun Bitti! MusCoin: ${score + accumulatedPoints}`;
            gameOver = true;
            accumulatedPoints = 0;  // Mayƒ±na basƒ±nca biriken puarƒ± sƒ±fƒ±rlama
        } else {
            cell.classList.add('revealed');
            // Hi√ßbir ≈üey g√∂sterme (bo≈ü h√ºcreler)
            accumulatedPoints += enteredPoints; // Biriken puana ekle
            document.getElementById("pointsAccumulated").textContent = `Biriken MusCoin: ${Math.floor(accumulatedPoints)}`; // Biriken puanƒ± tam sayƒ± olarak g√∂ster
        }

        if (revealedCount === gridSize * gridSize - numMines) {
            document.getElementById("message").textContent = `Tebrikler, Kazandƒ±nƒ±z! Puanƒ±nƒ±z: ${score + accumulatedPoints}`;
            gameOver = true;
        }
    }

    // T√ºm mayƒ±nlarƒ± g√∂ster
    function showAllMines() {
        for (let row = 0; row < gridSize; row++) {
            for (let col = 0; col < gridSize; col++) {
                const cell = document.getElementById(`cell-${row}-${col}`);
                if (board[row][col].mine && !board[row][col].revealed) {
                    cell.classList.add('mine');
                    cell.textContent = 'üí£';
                }
            }
        }
    }

    // Tahtayƒ± kullanƒ±cƒ±ya g√∂ster
    function createBoardUI() {
        const boardElement = document.getElementById('board');
        boardElement.innerHTML = ''; // Tahtayƒ± temizle

        for (let row = 0; row < gridSize; row++) {
            for (let col = 0; col < gridSize; col++) {
                const button = document.createElement('button');
                button.id = `cell-${row}-${col}`;
                button.addEventListener('click', () => revealCell(row, col));
                boardElement.appendChild(button);
            }
        }
    }

    // Oyun ba≈ülat
    function startGame() {
        if (score <= 0) {
            document.getElementById("errorMessage").textContent = 'Yeterli MusCoiniz yok!';
            return; // Eƒüer puan 0 veya daha d√º≈ü√ºkse, oyunu ba≈ülatma
        }

        const inputMineCount = document.getElementById('mineCount').value;
        const inputEnteredPoints = document.getElementById('enterPoints').value;

        numMines = Math.min(Math.max(parseInt(inputMineCount), 1), 40); // Mayƒ±n sayƒ±sƒ±nƒ± 1 ile 40 arasƒ±nda sƒ±nƒ±rlayƒ±n
        enteredPoints = parseInt(inputEnteredPoints); // Giri≈ü i√ßin harcanan puanƒ± alƒ±n

        // Mayƒ±n sayƒ±sƒ±na baƒülƒ± olarak harcama yapma yerine sadece girilen puan miktarƒ±nƒ± kullan
        spentPoints = enteredPoints;  // Yalnƒ±zca girilen puan harcanƒ±r
        score -= spentPoints;         // Harcanan puan, kullanƒ±cƒ± puanƒ±ndan √ßƒ±kar

        // Eƒüer puan 0'ƒ±n altƒ±na d√º≈üerse, "Para Eksik" mesajƒ± g√∂ster
        if (score < 0) {
            document.getElementById("errorMessage").textContent = 'Para Eksik!';
            score = 0; // Puan sƒ±fƒ±rlanƒ±r
        } else {
            document.getElementById("errorMessage").textContent = ''; // Hata mesajƒ±nƒ± sƒ±fƒ±rla
        }

        document.getElementById("score").textContent = `MusCoin: <img src="muscoin.png" alt="coin"> ${score}`;
        document.getElementById("spent").textContent = `Giri≈ü i√ßin harcanan MusCoin: <img src="muscoin.png" alt="coin"> ${spentPoints}`;

        createBoard();  // Yeni tahtayƒ± olu≈ütur
        createBoardUI(); // Tahtayƒ± UI'ye ekle
        gameOver = false; // Oyunu yeniden ba≈ülat
        accumulatedPoints = 0; // Biriken puanlarƒ± sƒ±fƒ±rla
        document.getElementById("message").textContent = ''; // Oyun mesajƒ±nƒ± sƒ±fƒ±rla
    }

    // Puan √ßekme fonksiyonu
    function spendPoints() {
        if (accumulatedPoints > 0) {
            const totalPointsToAdd = Math.floor(accumulatedPoints); // √áekilen puanƒ± tam sayƒ±ya yuvarla
            score += totalPointsToAdd;
            document.getElementById("score").textContent = `MusCoin: <img src="muscoin.png" alt="coin"> ${score}`;
            document.getElementById("spent").textContent = `Giri≈ü i√ßin harcanan MusCoin: <img src="muscoin.png" alt="coin"> 0`;
            document.getElementById("pointsAccumulated").textContent = `Biriken MusCoin: <img src="muscoin.png" alt="coin"> 0`;
            document.getElementById("spendMessage").textContent = `MusCoin ba≈üarƒ±yla √ßekildi: ${totalPointsToAdd}`;

            // T√ºm mayƒ±nlarƒ± g√∂ster
            showAllMines();

            accumulatedPoints = 0; // Biriken puanƒ± sƒ±fƒ±rla
            gameOver = true; // Oyun bitir
        } else {
            document.getElementById("spendMessage").textContent = 'Hen√ºz biriken MusCoin yok!';
        }
    }
</script>

</body>
</html>
